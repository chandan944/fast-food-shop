name: ğŸš€ Build & Push Docker Image

on:
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]

jobs:
  build-and-push:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸ§° Set up JDK 21
        uses: actions/setup-java@v4
        with:
          distribution: "temurin"
          java-version: "21"

      - name: ğŸ“¦ Build Spring Boot App (Skips tests)
        run: |
          cd Baito/Baito
          chmod +x mvnw
          ./mvnw clean package -DskipTests

      - name: ğŸ³ Login to Docker Hub
        uses: docker/login-action@v3
        with:
          username: chandanprajapati7
          password: M@x200523

      - name: ğŸ— Build & Push Docker Image ğŸš€
        uses: docker/build-push-action@v4
        with:
          context: Baito/Baito
          file: Baito/Baito/Dockerfile
          push: true
          tags: |
            chandanprajapati7/fast-food-shop:latest
            chandanprajapati7/fast-food-shop:${{ github.run_number }}
